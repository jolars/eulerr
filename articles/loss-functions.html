<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Loss Functions • eulerr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Loss Functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eulerr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">7.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gallery.html">A Gallery of Euler and Venn Diagrams</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introducing eulerr</a></li>
    <li><a class="dropdown-item" href="../articles/loss-functions.html">Loss Functions</a></li>
    <li><a class="dropdown-item" href="../articles/under-the-hood.html">eulerr under the hood</a></li>
    <li><a class="dropdown-item" href="../articles/venn-diagrams.html">Venn diagrams with eulerr</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualizing Euler diagrams with eulerr</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jolars/eulerr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Loss Functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jolars/eulerr/blob/main/vignettes/loss-functions.Rmd" class="external-link"><code>vignettes/loss-functions.Rmd</code></a></small>
      <div class="d-none name"><code>loss-functions.Rmd</code></div>
    </div>

    
    
<p>eulerr features multiple loss functions, which result in different
diagrams for many combinations. In this vignette, we visualize the
effect of the loss function on an example from an issue <a href="https://github.com/jolars/eulerr/issues/93" class="external-link">posted on the GitHub
repository for eulerr</a>.</p>
<p>We list the combinations below, which consists of 5 different sets,
<em>agc</em>, <em>camk</em>, <em>cmgc</em>, and <em>tk</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"agc"</span>                  <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  <span class="st">"camk"</span>                 <span class="op">=</span> <span class="fl">17</span>,</span>
<span>  <span class="st">"cmgc"</span>                 <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  <span class="st">"tk"</span>                   <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  <span class="st">"tkl"</span>                  <span class="op">=</span> <span class="fl">23</span>,</span>
<span>  <span class="st">"agc&amp;camk"</span>             <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"camk&amp;tk"</span>              <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"tk&amp;tkl"</span>               <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"camk&amp;cmgc&amp;tkl"</span>        <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"camk&amp;tk&amp;tkl"</span>          <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="st">"agc&amp;camk&amp;tk&amp;tkl"</span>      <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"camk&amp;cmgc&amp;tk&amp;tkl"</span>     <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  <span class="st">"agc&amp;camk&amp;cmgc&amp;tk&amp;tkl"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Notice that the sizes of most of the intersections are small compared
to the size of the sets themselves and that many of the intersections
are missing. Generating an exact Euler diagram that shows these
intersections and at the same time omits the intersections that are here
implicitly 0 is an impossible problem, which means that the best we can
do is an approximation.</p>
<p>What kind of approximation we get depends on the loss functions we
use. If we use the default, which in <strong>eulerr</strong> is the sums
of squared errors, we will almost certainly get a design in which the
intersections involving many sets are missing since including them
inevitably leads to larger errors from having to include other
intersections that are not present.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jolars/eulerr" class="external-link">eulerr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/euler.html">euler</a></span><span class="op">(</span><span class="va">combos</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="loss-functions_files/figure-html/unnamed-chunk-3-1.png" alt="An Euler diagram fit to the combination given earlier on, showing that only 1-by-1 intersections are present. This fit uses the default loss function, the sum of squared errors." width="700"><p class="caption">
An Euler diagram fit to the combination given earlier on, showing that
only 1-by-1 intersections are present. This fit uses the default loss
function, the sum of squared errors.
</p>
</div>
<p>If we rather want a diagram that includes these intersections,
despite leading to errors for the zero-intersections, then we need to
switch the loss function we use. In <strong>eulerr</strong>, you can do
so via the two arguments <code>loss</code> and
<code>loss_aggregator</code> in <code><a href="../reference/euler.html">euler()</a></code>. We start by
listing the alternatives for the <code>loss</code> argument.</p>
<table class="table">
<caption>Loss functions in <strong>eulerr</strong>
</caption>
<thead><tr class="header">
<th align="left">Loss</th>
<th align="left">Input</th>
<th align="left">Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Squared errors</td>
<td align="left"><code>square</code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><annotation encoding="application/x-tex">(y_i - \hat y_i)^2</annotation></semantics></math></td>
</tr>
<tr class="even">
<td align="left">Absolute errors</td>
<td align="left"><code>abs</code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|y_i - \hat y_i|</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td align="left">RegionErrors</td>
<td align="left"><code>region</code></td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mi>i</mi></msub><mi>/</mi><msub><mo>∑</mo><mi>k</mi></msub><msub><mi>y</mi><mi>k</mi></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mi>/</mi><msub><mo>∑</mo><mi>k</mi></msub><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mi>k</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mo></mrow><annotation encoding="application/x-tex">\big|y_i/\sum_k y_k - \hat y_i / \sum_k \hat y_k \big|</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>How the final loss is computed depends on the value of
<code>loss_aggregator</code>, which is the function used to aggregate
the values computed for each set intersection via the function used in
<code>loss</code>. The two available settings are <code>"sum"</code> and
<code>"max"</code>, which should be self-explanatory.</p>
<p>That means that <code>loss = "square"</code> and
<code>loss_aggregator = "sum"</code> leads to the sum of squared errors.
<code>loss = "region"</code> uses <em>regionError</em>, which is a loss
metric introduced by <span class="citation">(Micallef and Rodgers
2014)</span>. Together with <code>loss_aggregator = "max"</code>,
<code><a href="../reference/euler.html">euler()</a></code> will use <em>diagError</em> (introduced in the same
paper).</p>
<p>To see what these different choices mean for the combination that we
have looked at, we now refit the diagram for each combination.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">losses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"square"</span>, <span class="st">"abs"</span>, <span class="st">"region"</span><span class="op">)</span></span>
<span><span class="va">aggregators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"max"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">loss</span> <span class="kw">in</span> <span class="va">losses</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">aggregator</span> <span class="kw">in</span> <span class="va">aggregators</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/euler.html">euler</a></span><span class="op">(</span><span class="va">combos</span>, loss <span class="op">=</span> <span class="va">loss</span>, loss_aggregator <span class="op">=</span> <span class="va">aggregator</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">aggregator</span>, <span class="va">loss</span>, sep <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure">
<img src="loss-functions_files/figure-html/unnamed-chunk-4-1.png" alt="Euler diagrams fit to the combination above, using different loss function" width="288"><img src="loss-functions_files/figure-html/unnamed-chunk-4-2.png" alt="Euler diagrams fit to the combination above, using different loss function" width="288"><img src="loss-functions_files/figure-html/unnamed-chunk-4-3.png" alt="Euler diagrams fit to the combination above, using different loss function" width="288"><img src="loss-functions_files/figure-html/unnamed-chunk-4-4.png" alt="Euler diagrams fit to the combination above, using different loss function" width="288"><img src="loss-functions_files/figure-html/unnamed-chunk-4-5.png" alt="Euler diagrams fit to the combination above, using different loss function" width="288"><img src="loss-functions_files/figure-html/unnamed-chunk-4-6.png" alt="Euler diagrams fit to the combination above, using different loss function" width="288"><p class="caption">
Euler diagrams fit to the combination above, using different loss
function
</p>
</div>
<p>As you can see, the errors that sum either the absolute or squared
errors result in very similar fits and keep the existing two-set
intersections and drop everything else. The <code>abs</code> +
<code>max</code> and <code>max</code> + <code>square</code> combos,
meanwhile, produce fits that are much more unpredictable since they only
care about the largest error. Finally, <em>diagError</em> results in
diagrams that tries to include many more intersections at the cost of
reducing the goodness-of-fit of the larger intersections.</p>
<p>Feel free to raise a request (or better yet, a pull request) at <a href="https://github.com/jolars/eulerr/issues" class="external-link uri">https://github.com/jolars/eulerr/issues</a> if you know of
any other loss function that you think should be included in the
package.</p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Micallef_2014a" class="csl-entry">
Micallef, Luana, and Peter Rodgers. 2014. <span>“<span class="nocase">eulerAPE</span>: Drawing Area-Proportional
3-<span>Venn</span> Diagrams Using Ellipses.”</span> <em>PLOS ONE</em> 9
(7): e101717. <a href="https://doi.org/10.1371/journal.pone.0101717" class="external-link">https://doi.org/10.1371/journal.pone.0101717</a>.
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johan Larsson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
